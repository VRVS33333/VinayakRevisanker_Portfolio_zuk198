<<<<<<< HEAD
---
title: "Example Manuscript Template for a Data Analysis Project"
subtitle: ""
author: Vinayak Revisanker
date: "`r Sys.Date()`"
format:
  docx:
    toc: false
    number-sections: true
    highlight-style: github
bibliography: ../../assets/dataanalysis-references.bib
csl: ../../assets/apa.csl
---

The structure below is one possible setup for a data analysis project (including the course project). For a manuscript, adjust as needed. 
You don't need to have exactly these sections, but the content covering those sections should be addressed.

This uses MS Word as output format. [See here](https://quarto.org/docs/output-formats/ms-word.html) for more information. You can switch to other formats, like html or pdf. See [the Quarto documentation](https://quarto.org/) for other formats.


```{r}
# R packages
library(here)
library(knitr)
library(DescTools)
library(ResourceSelection)
library(MASS) 
library(car) 
library(olsrr)
library(LearnBayes)
library(ggplot2)
library(caret)
library(earth)
library(tidyverse)
library(hms)
```



```{r}
# Read the CSV file
file_path <- "Methane in the Furnance.csv"
df <- read_csv(file_path)

# Convert 'obs' column to time format
df <- df %>% mutate(obs = hms::as_hms(obs))

# Check for missing values
missing_values <- colSums(is.na(df))
print(missing_values)

# Handle missing values by filling with mean
df <- df %>% mutate(
  co2 = ifelse(is.na(co2), mean(co2, na.rm = TRUE), co2),
  methane = ifelse(is.na(methane), mean(methane, na.rm = TRUE), methane)
)

# Summary statistics
co2_summary <- summary(df$co2)
methane_summary <- summary(df$methane)

# Print summary statistics
print(co2_summary)
print(methane_summary)

# Plot CO2 levels over time
co2_plot <- ggplot(df, aes(x = obs, y = co2)) +
  geom_line(color = "blue") +
  labs(title = "CO2 Levels Over Time", x = "Time", y = "CO2 Level") +
  theme_minimal()
ggsave("co2_plot.png", plot = co2_plot)

# Plot methane levels over time
methane_plot <- ggplot(df, aes(x = obs, y = methane)) +
  geom_line(color = "orange") +
  labs(title = "Methane Levels Over Time", x = "Time", y = "Methane Level") +
  theme_minimal()
ggsave("methane_plot.png", plot = methane_plot)

# Calculate the correlation between CO2 and methane levels
correlation <- cor(df$co2, df$methane, use = "complete.obs")
print(paste("Correlation between CO2 and methane levels:", correlation))

# Save the correlation result
dir.create("results", showWarnings = FALSE)
write(paste("Correlation between CO2 and methane levels:", correlation), 
      file = "results/analysis_summary.txt")

# Additional analysis using base R
# Split the data into training and testing sets
set.seed(123)
train_indices <- sample(1:nrow(df), size = 0.8 * nrow(df))
train_data <- df[train_indices, ]
test_data <- df[-train_indices, ]

# Fit a linear model
lm_fit <- lm(co2 ~ methane, data = train_data)

# Model summary
lm_summary <- summary(lm_fit)
capture.output(lm_summary, file = "results/lm_summary.txt")

# Model evaluation
predictions <- predict(lm_fit, newdata = test_data)
actuals <- test_data$co2
residuals <- actuals - predictions
mse <- mean(residuals^2)
rmse <- sqrt(mse)
r_squared <- lm_summary$r.squared

# Print evaluation metrics
print(paste("RMSE:", rmse))
print(paste("R-squared:", r_squared))

# Save evaluation metrics
evaluation_metrics <- c(paste("RMSE:", rmse), paste("R-squared:", r_squared))
write(evaluation_metrics, file = "results/metrics_summary.txt")

# Create the manuscript directory
dir.create("manuscript", showWarnings = FALSE)

# Update the manuscript with new results
# Read in results for the manuscript
correlation <- readLines("results/analysis_summary.txt")
lm_summary <- readLines("results/lm_summary.txt")
metrics_summary <- readLines("results/metrics_summary.txt")

# Print the manuscript results
cat("Correlation between CO2 and methane levels:\n", correlation, "\n\n")
cat("Linear Model Summary:\n", lm_summary, "\n\n")
cat("Model Evaluation Metrics:\n", metrics_summary, "\n\n")

# Write the manuscript results to a file
manuscript_path <- "manuscript/results.txt"
writeLines(c("Correlation between CO2 and methane levels:", correlation, 
             "\n\nLinear Model Summary:\n", lm_summary, 
             "\n\nModel Evaluation Metrics:\n", metrics_summary), 
           con = manuscript_path)



```




# Discussion

## Summary and Interpretation
_The analysis showed that both CO2 and methane levels fluctuate over time. The correlation between the two gases will provide insight into their relationship in the furnace environment._

## Strengths and Limitations
_Discuss what you perceive as strengths and limitations of your analysis._

## Conclusions
_Understanding the behavior of methane and carbon dioxide in furnaces can help in developing better control strategies to reduce emissions. Further research with more context-specific data is recommended._



# References



>>>>>>> 0a8029a263c0a128bc84961770acd801f698db05
